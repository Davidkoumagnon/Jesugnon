---
title: |
  \
  \includegraphics[width=6cm]{C:/Users/Admiral/Downloads/ASE_logo.jpg}
  **Quantitative Finance**
author: "Jesugnon David Janvier KOUMAGNON"
date: "_`r format(Sys.time(), '%d %B, %Y')`_"
output:
  html_document:
    toc: yes
    df_print: paged
  pdf_document: 
    toc: true
    keep_tex: true
    latex_engine: xelatex
header-includes:
- \usepackage{pdfpages}
- \usepackage{graphicx}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

\newpage

# Introduction

Quantitative finance is a branch of applied mathematics that uses mathematical and statistical methods to analyze financial markets and instruments. One of the main challenges in quantitative finance is to model the behavior of asset prices over time, which can be influenced by various factors such as economic conditions, market sentiment, supply and demand, etc. A common approach to model asset prices is to use autoregressive integrated moving average (ARIMA) models, which capture the temporal dependence and stochastic trends of time series data. However, different frequencies of data may require different ARIMA specifications, and choosing the best model can be a complex and tedious task. In this paper, we use the best subsets ARIMA approach, which is a data-driven method that selects the optimal ARIMA model based on a criterion: the Akaike information criterion (AIC). We apply this approach to daily, weekly and monthly data of one stock in the last five years, and compare the results and implications of the best models for each frequency.

# 1. Download of the data

Library or packages used

```{r message=FALSE, warning=FALSE}
rm(list = ls(all = TRUE)); graphics.off()
set.seed(88)
listofpackages <- c("TSA", "forecast", "astsa", "urca", 
                    "quantmod", "tseries","stargazer", "sandwich", 
                    "tinytex", "kableExtra", "psych","writexl",
                    "ggplot2", "alphavantager", "tidyquant") 
for (j in listofpackages){
  if(sum(installed.packages()[, 1] == j) == 0) { install.packages(j) }
  library(j, character.only = T)
}
```

## 1.1. Presentation of the stock market index

**Super Micro Computer,** **Inc.**$(SMCI)$ is a multinational technology company specializing in the design and production of computer hardware solutions, with a particular emphasis on server technologies. The analysis conducted on SMCI involves employing ARIMA modeling techniques using historical daily prices of the company's stock. The study spans a period of almost five years, from $January$ $2019$ to $January$ $2024.$ To obtain the stock prices, the analysis utilizes the *"quantmod"* package in the R programming language, querying the Yahoo! Finance database with the stock symbol *"SMCI"*. The closing price is selected as the variable to be modeled. This decision is driven by the recognition that the closing price comprehensively reflects various corporate actions, such as dividends, stock splits, and new stock offerings. Considering these factors, the closing price is deemed to offer a more precise representation of the company's value.The ARIMA model building process is applied to daily, weekly, and monthly closing prices of SMCI's stock throughout the specified timeframe. This comprehensive approach aims to capture underlying trends and patterns in the time series data, providing insights into the behavior of SMCI's stock. The study is designed to enhance understanding and potentially reveal valuable information about the company's stock performance over the analyzed period.

## 1.2. Data downloding from yahoo Finance

```{r include=FALSE}
getSymbols(Symbols = "SMCI", src = "yahoo", from="2019-01-01", to="2024-01-01")
# Store the index in vector ind
ind <- index(SMCI)

# Ensure DIS is in the correct format
SMCI <- as.data.frame(SMCI)

# Add the 'datetime' column to DIS
SMCI$datetime <- ind

# Generate a sequence of dates
date_seq <- seq(as.Date("2019-01-02"), as.Date("2024-01-02"), by = "1 day")

# Create a data frame with the sequence of dates
date_df <- data.frame(Date = date_seq)

# Merge with the original data using 'dattime'
merged_df <- merge(date_df, SMCI, by.x = "Date", 
                   by.y = "datetime", all.x = TRUE)

# Sort the merged data frame by date
merged_df <- merged_df[order(merged_df$Date, decreasing = FALSE), ]

merged_df$Date <- as.Date(merged_df$Date)



# Convert to time series
SMCI <- xts(merged_df[,-1], order.by = merged_df$Date)

colnames(SMCI) <-c("Open","High","Low","Close",
                   "Volume","Adjusted")

# Handle missing values
SMCI <- na.locf(SMCI)

# Save the time series object
save(SMCI, file = "SMCI.RData")


# Save as an Excel file
write_xlsx(data.frame(date = time(SMCI), coredata(SMCI)), "SMCI_Data.xlsx")
SMCI <- SMCI$Close
SMCI.W <- to.weekly(SMCI)
SMCI.M <- to.monthly(SMCI)
```

# 2. Time Series Plot of Daily Close Data for SMCI

## 2.1. Plot

```{r echo=FALSE}
plot(SMCI, main = "Close Plot of Daily data for SMCI", col="red",
     xlab="Time", ylab="Price")
```

## 2.2. Explanation

The graph illustrates the daily closing prices for the SMCI stock from January 2, 2019, to January 2, 2024.

For about three years, from the start of 2019 until mid-2022, the stock price remains relatively low with minor fluctuations. This suggests a period of relative stability for the SMCI stock.Around mid-late 2022, there’s a sharp increase in the stock’s value, where it peaks slightly above \$350. This could indicate a significant positive development for the company or a favorable market condition that led to increased investor confidence.After reaching its peak, the stock price shows noticeable fluctuations, indicating increased volatility. However, it still maintains a high value compared to the initial years. This could suggest that while the market has reacted to some changes, the stock’s value remains high.Based on the graph we can say that its appear with a stong seasonilty and **non stationary**.

# 3. Use of the best subsets ARIMA approach to specify a model for the daily close data

## 3.1. Descriptive statistics and decomposition of the daily close data

-   Decomposition of the daily close data

```{r echo=FALSE, message=FALSE}
# Transformation of the data
SMCI.D <- ts(SMCI, start = c(2019,1,1), end = c(2024,1,1), frequency =365)
plot(decompose(SMCI.D))
```

The graph shows the decomposition of the series into its constituent components. The chart includes four plots: "Observed," "Trend," "Seasonal," and "Random." From2 it we can say, it does not appear to have a clear seasonal component. The graph shows a relatively stable trend from 2020 until early 2022. Around early 2022, there is a sharp increase in the Close value, reaching up towards 300 by mid-2023. After this rapid increase, the line shows high volatility with sharp rises and falls. This pattern does not suggest a regular, repeating pattern that would indicate a seasonal component. Instead, it seems more related to specific events or changes occurring around early 2022. We can conclude that the series presents a trend and **is not stationary**

-   Descriptive statistics

```{r echo=FALSE}
summary(SMCI.D)
```

To confirm one more time that our daily data is not stationary and present a sesonality, we conducted the ADF and Box- Pierce test and the result is given as follow:

```{r echo=FALSE}
adf.test(log(SMCI))
```

The results of the ADF test are shown above. At the $5\%$significance level, the null hypothesis $(H0)$ of the existence of a unit root in the daily stock is accepted (because the p-value $(0.7873)$ higher than $5\%$). These results indicate that the $SMCI$ series is **not stationary**.

```{r echo=FALSE}
Box.test(log(SMCI.D), lag = 365)
```

The p-value $(< 2.2e-16)$ is much smaller than the significance level (usually $0.05$), indicating that we can reject the null hypothesis of no seasonality (autocorrelation). This strongly suggests the presence of seasonality with a daily frequency.

To address the trend observed in our time series data, we will apply a technique known as differentiation. This process involves calculating the difference between consecutive observations, effectively transforming the data into a series of changes rather than absolute values. By doing so, we aim to remove the trend and seasonality, thereby simplifying further analysis

```{r echo=FALSE}
# Remove the trend and seasonality through differentiation
d.SMCI <- diff(log(SMCI.D))
plot(d.SMCI)

d.365SMCI <- diff(d.SMCI, lag=365)
plot(d.365SMCI)
```

From the plot of first difference of SMCI price close, we can see that the series has sometimes low and sometimes high volatility, and we can see a very significant spike in the beginning of 2020 due to the COVID-19 crisis.The long volatility observed during 20222 is due to the negative impact on the world economy.

From plot we can see that the trend does not appear, but the first difference series is varied during the time (around zero). ***In particular, the variance. We can also remark that the series like white noise.***

-   Test of the stationarity using the ADF test

```{r echo=FALSE}
adf.test(d.365SMCI)
```

The results of the ADF test are shown above. At the $5\%$significance level, the null hypothesis $(H0)$ of the existence of a unit root in the daily stock returns is rejected (because the p-value $(0.01)$ is less than $5\%$). These results indicate that the $SMCI$ return series is stationary.

Since we found that our data is stationary after removing the trend, we can now find the order of **p** and **q** that will help us to model the best subset of ARIMA according to our daily time series.

I now plot the autocorrelation function plot $(ACF)$ and the partial autocorrelation function plot (PACF). The ACF help us to find the Moving average order (p) and the PCAF, the Auto-regression process (p).

```{r echo=FALSE}
invisible(acf2(d.365SMCI, 20))
ggtsdisplay(d.365SMCI, lag.max =1455)
```

The Autocorrelation Function (ACF) plot for the first difference of the S&P 500 stock shows that most of the ACF values are close to zero. This suggests that there is little to no autocorrelation in the data series, which is a characteristic of white noise.

Moreover, the fact that the ACF values drop to zero relatively quickly indicates that the series is stationary. In a stationary time series, statistical properties like mean, variance, and autocorrelation are all constant over time. According to graph, the value of the Q will be between 0 and 1.

In my PACF plot, it appears that the partial auto correlations drop to zero after the first or second lag. This suggests that a 'p' value of 1 or 2.

Overall observation of the ACF and PACF suggests some models to consider. Four different models that comes to mind are as follows:

Given these values, the possible ARIMA models for our time series data could be:

1.  $ARIMA(0,1,0)(0,1,0)_{365}$

2.  $ARIMA(0,1,1)(0,1,0)_{365}$

```{r echo=FALSE, warning=FALSE, results='asis'}
D.1 <- arima(log(SMCI.D), order = c(1, 1, 0), seasonal = list(order = c(0, 1, 0)))
checkresiduals(D.1)

D.2 <- arima(log(SMCI.D), order = c(0, 1, 1), seasonal = list(order = c(0, 1, 0)))
checkresiduals(D.2)

stargazer(D.1,D.2,title="Comparison ARIMA daily modelling", 
          column.labels = c("D.1",  "D.2" ), 
          type = "text", float = TRUE, report = "vcs*", 
          header=FALSE, single.row = FALSE, font.size =
            "footnotesize",digits = 2, p.auto = F)
```

Based on our analysis the ARIMA does not give us a best result let look at the subset give by the auto arima function.

```{r echo=FALSE}
auto.arima(log(SMCI.D), trace = TRUE )
Dauto <- arima(log(SMCI), order=c(0,1,0), include.mean = TRUE)
checkresiduals(Dauto)
```

Based on the result, the best model is the ARIMA(0,1,0) with drift.

# 4. Use of the best subsets ARIMA approach to specify a model for the weekly close data

## 4.1. Time Series Close Plot of weekly data for SMCI

```{r echo=FALSE}
SMCI.W <- SMCI.W$SMCI.Close
SMCI.W <- ts(SMCI.W , start = c(2019,1), end = c(2023,12), frequency = 52)
plot(SMCI.W)
```

the graph shows a fluctuating trend from 2019 to 2023. It shows a general increase in the SMCI Close value over time, with noticeable volatility. The value was relatively stable around 20 from 2019 to mid-2020, then it started increasing significantly, reaching close to 100 by 2023. This could imply a significant event or change in the market conditions around that time

```{r echo=FALSE}
plot(decompose(SMCI.W))
```

This plot shows a smoothed version of the observed data to highlight underlying patterns. A smooth increasing linear pattern is visible without short-term fluctuations

## 4.2. Stationary of the weekly series

```{r echo=FALSE}
adf.test(log(SMCI.W))
```

The Augmented Dickey-Fuller test result suggests that the log of the weekly SMCI data is not stationary since the p-value is 0.2909, which is greater than the common significance level (0.05). This means there’s a trend or seasonality in the data.

```{r echo=FALSE}
d.SMCIW <- diff(log(SMCI.W))
plot(d.SMCIW)
d.52SMCI <- diff(d.SMCIW, lag=52)
plot(d.52SMCI)
```

```{r echo=FALSE}
adf.test(d.52SMCI)
```

The Augmented Dickey-Fuller test result after differentiation suggests that the differentiated weekly SMCI data is stationary since the p-value is 0.01, which is less than the common significance level (0.05). This means the differentiated data does not have a unit root and does not exhibit time-dependent structure.

## 4.3.Plot of the ACF and PACF

```{r echo=FALSE}
invisible(acf2(d.52SMCI, 150))
```

W1: $(0,1,0)(1,1,0)_{52}$

W2: $(0,1,1)(1,1,1)_{52}$

W3: $(0,1,1)(1,1,1)_{52}$

W4: $(0,1,1)(1,1,0)_{52}$

W5: $(1,1,0)(0,1,1)_{52}$

W6: $(0,1,1)(0,1,1)_{52}$

```{r echo=FALSE, results='asis'}
W1 <- arima(log(SMCI.W), order = c(0, 1, 0),  seasonal = list(order = c(1, 1,0), period=52))
checkresiduals(W1)

W2 <- arima(log(SMCI.W), order = c(0,1,1), seasonal = list(order = c(1, 1,1), period=52))
checkresiduals(W2)

W3 <- arima(log(SMCI.W), order = c(0, 1, 1), seasonal = list(order = c(1,1,1), period=52))
checkresiduals(W3)

W4 <- arima(log(SMCI.W), order = c(0,1,1), seasonal = list(order = c(1, 1,0), period=52))
checkresiduals(W4)

W5 <- arima(log(SMCI.W), order = c(1,1,0), seasonal = list(order = c(0, 1,1), period=52))
checkresiduals(W5)

W6 <- arima(log(SMCI.W), order = c(0,1,1), seasonal = list(order = c(0, 1,1), period=52))
checkresiduals(W6)

stargazer(W1,W2,W3, W4,W5,W6,title="Comparison ARIMA weekly modelling", 
          column.labels = c("W1",  "W2", "W3", "W4",
                            "W5", "W6"),
          type = "text", float = TRUE, report = "vcs*", 
          header=FALSE, single.row = FALSE, font.size =
            "footnotesize",digits = 2, p.auto = F)
```

based on the table and the criteria we are using, checking residual and AIC, the best model is given by W1: $(0,1,0)(1,1,0)_{52}$

Using the auto Arima, we obtain this.

```{r echo=FALSE}
auto.arima(log(SMCI.W), trace=TRUE)
Wauto <- arima(log(SMCI.W), order = c(0,1,1), include.mean = TRUE)
checkresiduals(Wauto)
```

Based on the auto arima result, the best model is the $ARIMA(0,1,0)(1,1,0)_{52}$ that we point out through our analysis (is better) because it has the lowest AIC and its residuals follow the normal distribution and respect all the assumption of the selection.

# 5. Use of the best subsets ARIMA approach to specify a model for the monthly close data

## 5.1. Time Series Close Plot of monthly data for SMCI

```{r echo=FALSE}
SMCI.M <- SMCI.M$SMCI.Close
SMCI.M <- ts(SMCI.M , start = c(2019,1), end = c(2024,1), frequency = 12)
plot(SMCI.M)
```

```{r echo=FALSE}
plot(decompose(SMCI.M))
```

```{r echo=FALSE}
adf.test(log(SMCI.M))
```

The Augmented Dickey-Fuller (ADF) test was conducted on the log-transformed SMCI.M time series data to assess its stationarity. The obtained test statistic was -1.4912, with a lag order of 3 and an associated p-value of 0.7806. The higher p-value suggests that we fail to reject the null hypothesis, implying insufficient evidence to conclude that the time series is stationary. The non-stationarity of the series, as suggested by the ADF test, indicate the presence of a unit root.

To make the series stationary, we pass through the differentiation process. The plot is depicted as follow.

```{r echo=FALSE}
d.SMCIM <- diff(log(SMCI.M))
plot(d.SMCIM)
adf.test(d.SMCIM)
```

The Augmented Dickey-Fuller (ADF) test was applied to the differenced log-transformed SMCI.M time series (d.SMCIM). The test resulted in a Dickey-Fuller statistic of -4.0098 and a p-value of 0.01527. The low p-value indicates that the differenced series is stationary, suggesting the absence of a unit root. This supports the conclusion that differencing has effectively stabilized the time series, making it suitable for the analysis.

```{r echo=FALSE}
invisible(acf2(d.SMCIM))
```

The Autocorrelation Function (ACF) and Partial Autocorrelation Function (PACF) were examined for the monthly time series data after differentiation.

The ACF graph illustrates how the series correlates with itself at different time lags. Notably, most of the bars fall within the confidence intervals, indicating that there is no noteworthy autocorrelation in this time series data. This implies that the values in the series are not significantly influenced by their past values.

Similarly, the PACF graph depicts the correlation of the series with itself at different lags, excluding shorter lags. Like the ACF graph, the majority of the bars stay within the confidence intervals, suggesting a lack of substantial autocorrelation.

In summary, the ACF and PACF graphs collectively indicate that the time series data does not demonstrate significant autocorrelation within the examined lags. This suggests that the current values in the time series are not heavily reliant on their past values, at least within the specified lag range meaning that the model is directly **a white noise ARIMA(0,1,0)**

```{r echo=FALSE}
M1 <-arima(log(SMCI.M), order=c(0, 1, 0))
summary(M1)
checkresiduals(M1)
```

The model presents a very low $AIC (-46.77)$, with a residuals without autocorrelation and following a normal distribution. Let's look at the model suggest by the auto ARIMA function.

```{r echo=FALSE}
auto.arima(log(SMCI.M), trace=TRUE)
Mauto <- arima(log(SMCI.M), order=c(0,1,0), include.mean = TRUE)
checkresiduals(Mauto)

```

The result of the auto ARIMA same exactly the same with the one we suggest. The best subset of ARIMA for the monthly data is there $ARIMA(0,1,0)$

# 6. Comment on the the best model for weekly data.

```{r echo=FALSE}
#Forecasting for the next 3 year for weekly 
predW <- predict(W1, n.ahead = 3*52)
ts.plot(log(SMCI.W), predW$pred, lty = c(1,9))
```

Examining the 3-year forecast from the best models for weekly, it is evident that the trend in predictions appears consistent across the next 3 years.

# Conclusion

In conclusion, the quantitative finance analysis of Super Micro Computer, Inc. (SMCI) stock involved utilizing ARIMA modeling techniques on daily, weekly, and monthly closing prices spanning almost five years. The daily data exhibited fluctuations with a notable increase around mid-2022, reflecting increased volatility while maintaining a high value. However, the series presented strong seasonality and non-stationarity. Through differentiation, the daily series became stationary, paving the way for ARIMA modeling.

For the weekly data, the analysis revealed an increasing trend with significant volatility, and differentiation was applied to make the series stationary. The best subset ARIMA approach suggested the model ARIMA(0,1,0)(1,1,0)$_{52}$ as the most suitable for the weekly data.

Monthly data initially showed non-stationarity, confirmed by the Augmented Dickey-Fuller test. After differencing, the ACF and PACF indicated a lack of significant autocorrelation, leading to the selection of a white noise ARIMA(0,1,0) model.

The differences in the best models for daily, weekly, and monthly data highlight the importance of considering the data frequency and characteristics. The selected models can aid in forecasting future stock behavior, providing valuable insights for investment decisions. Overall, this quantitative finance analysis enhances our understanding of SMCI's stock performance over time.
